extends ../layout.pug

block title
    title History Query - Minecraft - ON Demand
block content
    #search.section.scrollspy
        .card.z-depth-2
            .card-content
                #app(v-cloak)
                    p.card-title #{texts.minecraft.history.title}
                    p #{texts.minecraft.history.description}
                    br
                    div(v-if="status == 'searching'")
                        .center-align
                            .preloader-wrapper.big.active
                                .spinner-layer.spinner-green-only
                                    .circle-clipper.left
                                        .circle
                                    .gap-patch
                                        .circle
                                    .circle-clipper.right
                                        .circle
                            br
                            br
                            p #{texts.minecraft.wait}
                    div(v-else-if="status == false")
                        .center-align
                            .card.red.lighten-2
                                .card-content.white-text
                                    span.card-title #{texts.minecraft.error.title}
                                    p #{texts.minecraft.error.not_exist}
                    div(v-else-if="status == 'uuid_null'")
                        .center-align
                            .card.red.lighten-2
                                .card-content.white-text
                                    span.card-title #{texts.minecraft.error.title}
                                    p #{texts.minecraft.error.null}
                    div(v-else-if="status == 'error'")
                        .center-align
                            .card.red.lighten-2
                                .card-content.white-text
                                    span.card-title #{texts.minecraft.error.title}
                                    p #{texts.minecraft.error.error}
                    div(v-else-if="status == true")
                        .center-align
                            .card.green.lighten-2
                                .card-content.white-text
                                    span.card-title #{texts.minecraft.success.title}
                                    p #{texts.minecraft.success.success}
                            .row
                                .col.s12.m4
                                    img(v-bind:src="'https://crafatar.com/renders/body/'+user.uuid+'?&default=MHF_Alex&overlay'")
                                table.col.s12.m6.bordered
                                    tr
                                        th #{texts.minecraft.UUID}
                                        td {{user.uuid}}
                                    tr
                                        th #{texts.minecraft.time}
                                        td {{user.query_time}}
                                table.col.s12.m6.bordered
                                    thead
                                        tr
                                            th #
                                            th #{texts.minecraft.nickname}
                                            th #{texts.minecraft.history.time}
                                    tbody
                                        tr(v-for="(item, index) in user.history")
                                            td {{index}}
                                            td {{item.name}}
                                            td(v-if="typeof item.changedToAt == 'number'") {{moment.unix(item.changedToAt / 1000).format('YYYY.MM.D. HH:mm:ss')}}
                                            td(v-else) #
                    div(v-if="form == true")
                        form.row(v-on:submit.prevent="onSubmit")
                            .input-field.col.s9
                                input#input(placeholder=texts.minecraft.UUID, type="text", v-model="query")
                                label(for="uuid") #{texts.minecraft.UUID}
                            .col.s3
                                input.btn.btn-large.green.darken-2(type="submit" value=texts.minecraft.search)
                noscript #{texts.minecraft.noscript}
    #info.section.scrollspy(style="min-height: 200px")
        .card.z-depth-2
            .card-content
                p.card-title #{texts.minecraft.information.title}
                div !{texts.minecraft.information.content}
    #help.section.scrollspy
        .card.z-depth-2
            .card-content
                p.card-title #{texts.minecraft.help.title}
                div !{texts.minecraft.help.content}
block scrollspy
    div
        ul.section.table-of-contents
            li
                a(href="#search") !{texts.minecraft.nick.menu.search}
            li
                a(href="#info") !{texts.minecraft.nick.menu.info}
            li
                a(href="#help") !{texts.minecraft.nick.menu.help}
block scripts
    script(async, src="/url.min.js")
    script(async, src="/moment/moment.min.js")
    script(async, src="/js/mchistory.min.js")